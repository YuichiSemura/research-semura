# LLM生成コードにおけるクローン問題

## 研究の問い（候補）

### Q1: LLM生成コードにはどの程度クローンが含まれるか？

- 学習データからの「記憶」による類似コード
- 異なるプロンプトから同一/類似コードが生成される頻度
- 測定方法: 既存クローン検出ツールでどこまで検出可能か？

### Q2: LLM生成コードのクローン検出には新しい手法が必要か？

- 従来のトークンベース/ASTベース手法の適用可能性
- LLM特有のパターン（例: コメントスタイル、変数命名）
- CCFinderSWの技術をどう拡張できるか？

### Q3: コードの出自（provenance）追跡は可能か？

- 「このコードはLLMが生成した」と判定できるか？
- 学習データのどのソースに由来するか特定可能か？
- 著作権・ライセンス問題への応用

### Q4: プロンプト-コード対応関係の分析

- 同じプロンプトからの生成コードの一貫性
- 類似プロンプトからの生成コードの類似度
- プロンプトエンジニアリングへの示唆

## 具体的なアプローチ案

### アプローチA: 大規模実験

- GitHub Copilot / CodeLlama等で大量のコード生成
- 既存クローン検出ツールで分析
- クローンの種類・頻度・パターンを定量化

### アプローチB: 検出手法の提案

- LLM生成コード特有のパターンを利用した検出手法
- CCFinderSWの拡張として実装可能か？

### アプローチC: 出自追跡ツール

- 生成コードと学習データの対応を推定
- ライセンス違反リスクの自動検出

## 関連研究（2025年1月更新）

- [x] LLMのmemorization問題 → `02-memorization.md`
- [x] Copilotの著作権訴訟関連 → `04-copilot-lawsuit.md`
- [x] コードクローン検出の最新手法 → `01-llm-clone-detection.md`
- [x] AI生成テキスト検出（コード版はあるか？） → `05-ai-code-detection-2025.md`
- [x] コード透かし研究 → `06-code-watermarking-2025.md`
- [x] CCFinderSWの引用状況 → `07-ccfindersw-citations.md`
- [x] LPcode詳細分析 → `08-lpcode-detailed.md`
- [x] DetectCodeGPT詳細分析 → `09-detectcodegpt-detailed.md`

### 主要な知見

1. **LLM生成コードの特徴**: コーディングスタイル（命名規則、インデント、コメント）でLLM生成を識別可能（LPcode論文）
2. **CCFinderSWの課題**: Type-3クローン非対応が複数論文で指摘される
3. **研究ギャップ**: トークンベース手法をLLM生成コードに適用した研究は見当たらない
4. **透かしの脆弱性**: 変数名変更・難読化でTPR<50%に低下 → 代替アプローチが必要

## 実現可能性メモ

- 強み: CCFinderSWの経験、トークナイザの知見
- 必要なもの: LLM API アクセス、計算リソース、評価用データセット
- 時間軸: 1〜2年
- **追加の強み**: CCFinder Retrospective論文（TSE 2025）でCCFinderファミリーの影響力が再確認された

## CCFinderSW引用分析からの示唆

- SolaSim等でベースラインとして使用されている
- Type-3対応が弱点として指摘 → 意味的類似度の追加で改善可能
- LLM生成コードへの適用は**未開拓**（引用論文にそのような研究なし）

## 次のアクション

1. [x] arXiv/Google Scholarで関連論文を10本程度収集
2. [x] Copilot訴訟の詳細を調査
3. [x] 既存のLLMコード検出研究があるか確認
4. [x] LPcode論文を詳細に読む → `08-lpcode-detailed.md`
5. [x] DetectCodeGPT（ICSE 2025）を読む → `09-detectcodegpt-detailed.md`
6. [ ] 小規模な予備実験のデザイン（Copilot/ChatGPT生成コード + CCFinderSW）

## LPcode・DetectCodeGPTからの具体的示唆

### CCFinderSWに応用可能な特徴（LPcodeより）

| 特徴 | CCFinderSWでの実装可能性 |
|------|------------------------|
| コメント比率 | ◎ トークナイザでコメントトークンをカウント |
| 命名規則（snake_case等） | ◎ 識別子トークンの分類 |
| インデント一貫性 | ○ 字句解析レベルで計測 |
| 関数長 | ○ トークン数で近似可能 |

### スタイリスティックトークン活用（DetectCodeGPTより）

- 空白・改行パターンは通常のクローン検出で**正規化されて消える**
- LLM生成判定には**保持するオプション**が有効
- CCFinderSWの前処理に「スタイル保持モード」を追加する案

### 統合ツールの構想

```
[入力コード]
    ↓
[CCFinderSW拡張版]
    ├── クローンペア検出（従来機能）
    ├── LLM生成判定（LPcodedec特徴）
    └── 生成元LLM推定（Task 2）
    ↓
[出力: クローン情報 + LLM生成確率 + 推定LLM]
```
