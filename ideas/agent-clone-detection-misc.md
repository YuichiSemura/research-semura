# 自律エージェント×クローン検出：その他のアイデア集

## 概要

自律エージェント（LLMベースのエージェント）とコードクローン検出を組み合わせた研究アイデアの整理。リファクタリング提案以外のアプローチをまとめる。

---

## アイデア1: クローン検出プロセス自体の自律化

### 概要

エージェントが複数のクローン検出ツールを状況に応じて使い分け、結果を統合する。

### 具体的なアプローチ

#### マルチツールオーケストレーション

- CCFinderSW, NiCad, SourcererCC等を状況に応じて選択
- 言語やプロジェクト規模に応じた最適なツール選択
- 各ツールの結果を統合・重複排除

#### 偽陽性フィルタリング

- 検出結果をエージェントがコンテキストを見て判断
- 「意図的な重複」（ボイラープレート、テンプレート）と「問題のあるクローン」を区別
- ドメイン知識を活用した判定

### 研究の問い

- エージェントによるツール選択は人間の判断とどの程度一致するか？
- 偽陽性フィルタリングの精度はどの程度か？

---

## アイデア2: セキュリティ脆弱性の伝播追跡

### 概要

脆弱性が発見されたコード片のクローンをコードベース全体から探索し、影響範囲を特定する。

### ワークフロー

```
1. CVEで脆弱性が報告される
2. 脆弱なコードパターンを特定
3. エージェントがクローン検出ツールで類似コードを探索
4. 影響範囲の特定
5. 修正パッチの自動生成・適用提案
```

### 研究の問い

- 脆弱性パターンのクローンはどの程度存在するか？
- 自動修正の適用可能性と安全性は？

### 関連

- セキュリティ×クローンの交差領域
- サプライチェーンセキュリティとの関連

---

## アイデア3: LLM生成コードの出自追跡（Provenance）

### 概要

LLMが生成したコードが、学習データ中のどのOSSコードに由来するかをクローン検出で特定する。

### 動機

- LLMの学習データには大量のOSSコードが含まれる
- 生成コードがライセンス違反になる可能性
- 「このコードはどこから来たのか」を追跡したいニーズ

### アプローチ

```
1. LLM生成コードを入力
2. エージェントがクローン検出ツールで大規模OSSコーパスと比較
3. 類似度の高いOSSコードを特定
4. ライセンス情報を取得
5. リスク評価レポートを生成
```

### 研究の問い

- クローン検出でLLM生成コードの出自を特定できるか？
- 検出精度と計算コストのトレードオフは？

### CCFinderSWとの関連

- **ユーザーの研究テーマに最も近い**
- CCFinderSWの拡張として自然な位置づけ

---

## アイデア4: LLMのクローン検出能力の評価

### 概要

LLM（Claude Code等）が「似た処理」を見つける能力を、学術的なクローン検出の観点から評価する。

### 背景

- Claude Codeは10〜20ファイル程度のリポジトリで類似コードを見つけられる
- しかしこれは従来のクローン検出とは根本的に異なるアプローチ

### 従来手法との比較

| 観点 | 従来のクローン検出 | LLM |
|------|-------------------|-----|
| 手法 | トークン列/AST比較 | 意味的理解 |
| 検出タイプ | Type-1〜3（構文的） | Type-4寄り（意味的） |
| スケール | 大規模リポジトリ対応 | コンテキスト制限あり |
| 網羅性 | 体系的・網羅的 | 見落としあり |
| 再現性 | 決定的 | 非決定的 |

### 研究の問い

- BigCloneBench等のベンチマークでLLMの精度・再現率は？
- LLMはType-4クローンをどの程度検出できるか？
- コンテキスト長はクローン検出精度にどう影響するか？

### 評価実験案

```
1. BigCloneBenchからクローンペアをサンプリング
2. LLMに「これらのコードは類似していますか？」と質問
3. 精度・再現率を計算
4. Type別（1〜4）の検出率を分析
```

---

## アイデア5: ハイブリッドアプローチ

### 概要

従来のクローン検出ツール（高速・網羅的）とLLM（意味的判断）を組み合わせる。

### アーキテクチャ

```
[ソースコード]
    ↓
[CCFinderSW] → 候補クローンペア（Type-2〜3）
    ↓
[LLMフィルタ] → 意味的に類似か判定
    ↓
[出力: 高精度クローンリスト]
```

### バリエーション

#### パターンA: LLMによる後フィルタリング

- CCFinderSWで候補を大量に抽出
- LLMで偽陽性を除去

#### パターンB: LLMによるType-4拡張

- CCFinderSWでType-2〜3を検出
- LLMでType-4（セマンティッククローン）を追加検出

### 研究の問い

- ハイブリッドアプローチは単独使用より精度が向上するか？
- 計算コストの増加に見合う価値があるか？

---

## アイデア6: LLMクローン検出の限界調査

### 概要

LLMがクローン検出できる範囲と限界を体系的に調査する。

### 調査項目

#### コンテキスト長の影響

- ファイル数が増えると検出精度はどう変化するか？
- どこまでスケールするか？

#### 変形への耐性

- どの程度のコード変形まで「類似」と判定できるか？
- Type-1〜4のどこまで対応できるか？

#### 言語依存性

- 言語によって検出精度は異なるか？
- LLMの学習データに多い言語は有利か？

### 評価実験案

```
1. 既知のクローンペアに段階的な変形を適用
   - 識別子名変更
   - 文の並び替え
   - ロジックの書き換え
2. 各段階でLLMが「類似」と判定するか確認
3. 検出限界を特定
```

---

## 優先度の検討

| アイデア | 新規性 | 実現可能性 | CCFinderSWとの関連 |
|---------|--------|-----------|-------------------|
| クローン検出プロセスの自律化 | 中 | 高 | 中 |
| セキュリティ脆弱性の伝播追跡 | 高 | 中 | 中 |
| **LLM生成コードの出自追跡** | **高** | **中** | **高** |
| LLMのクローン検出能力の評価 | 高 | 高 | 低 |
| ハイブリッドアプローチ | 中 | 高 | 高 |
| LLMクローン検出の限界調査 | 中 | 高 | 低 |

## 次のアクション

- [ ] 各アイデアの関連研究を調査
- [ ] 実現可能性の高いものから小規模実験を検討
- [ ] CCFinderSWの強みを活かせるアイデアを優先
